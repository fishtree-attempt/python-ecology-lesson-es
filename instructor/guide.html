<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Análisis y visualización de datos usando Python: Notas de Instructor</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="../assets/images/data-logo.svg"></div>
    </div>
    <div class="selector-container ">
      
      <div class="beta-alert alert alert-light alert-dismissable fade show" role="alert">
        
        
        
        <i aria-hidden="true" class="icon" data-feather="alert-circle" style="color: #5bbad5"></i>
        
        Workbench Beta | 
        <a href="https://carpentries.typeform.com/to/KRBl4IZM" class="external-link alert-link" style="text-decoration: wavy overline">Give Feedback</a> | 
        <a href="https://carpentries.github.io/workbench/beta-phase.html" class="external-link alert-link">Learn More</a>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../guide.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="../assets/images/data-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Análisis y visualización de datos usando Python
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Análisis y visualización de datos usando Python
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Análisis y visualización de datos usando Python
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
  <div id="sidebar-col" class="col-lg-4">
    <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle"><i class="search-icon" data-feather="x" role="img"></i></button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../guide.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-before-we-start.html">1. Antes de comenzar</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-short-introduction-to-Python.html">2. Breve introducción a la Programación en Python</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-starting-with-data.html">3. Comenzando con datos</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="03-index-slice-subset.html">4. Indexación, segmentación y creación de subconjuntos a partir de DataFrames en Python</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="04-data-types-and-format.html">5. Tipos de datos y formatos</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="05-merging-data.html">6. Combinando DataFrames con Pandas</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="06-loops-and-functions.html">7. Flujos de trabajo y automatización</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="07-visualization-ggplot-python.html">8. Creando gráficos con plotnine</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="08-putting-it-all-together.html">9. Entrada de datos y visualización - Matplotlib y Pandas</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="09-working-with-sql.html">10. Acceso a base de datos SQLite usando Python y Pandas</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/index.html" rel="prev"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/index.html" rel="next">Next... <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Notas de Instructor</h1>
        <p> Last updated on 2022-11-15 | 
        
        <a href="https://github.com/fishtree-attempt/python-ecology-lesson-es/edit/main/_extras/guide.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        
<div class="section level1">
<h1 id="soluciones-a-desafíos">Soluciones a desafíos<a class="anchor" aria-label="anchor" href="#soluciones-a-desaf%C3%ADos"></a></h1>
<div class="section level2">
<h2 id="instalar-los-paquetes-requeridos-para-el-taller">Instalar los paquetes requeridos para el taller<a class="anchor" aria-label="anchor" href="#instalar-los-paquetes-requeridos-para-el-taller"></a></h2>
<p>Por favor sigue las instrucciones del documento <a href="%7B%7Bpage.root%7D%7D%7B%%20link%20setup.md%20%%7D">Setup</a> para
instalar los programas necesarios para esta lección. Si encuentras
problemas, por favor crea un <strong>issue</strong> con la etiqueta
<strong>High-priority</strong>.</p>
</div>
<div class="section level2">
<h2 id="revisando-instalaciones">Revisando instalaciones<a class="anchor" aria-label="anchor" href="#revisando-instalaciones"></a></h2>
<p>En el directorio <code>_includes/scripts</code> encontrarás un
<strong>script</strong> llamado <code>check_env.py</code>. Éste revisa
la funcionalidad de la versión instalada de Anaconda.</p>
<p>Por defecto, Data Carpentry no requiere que la gente descargue el
repositorio completo con todos los scripts y apéndices. Por lo tanto,
como instructor, debes decidir cómo te gustaría proveer este script a
las estudiantes, si es que decides hacerlo. Para usarlo, las estudiantes
pueden navegar en su terminal hasta <code>_includes/scripts</code> y
ejecutar lo siguiente:</p>
<pre><code>python check_env.py</code></pre>
<p>{: .language-bash}</p>
<p>Si las estudiantes reciben un <code>AssertionError</code>, éste te
informará cómo ayudar a corregir la instalación. De lo contrario, ¡te
dirá que el sistema está listo para Data Carpentry!</p>
</div>
<div class="section level2">
<h2 id="short-introduction-to-python">01-short-introduction-to-Python<a class="anchor" aria-label="anchor" href="#short-introduction-to-python"></a></h2>
<div class="section level3">
<h3 id="desafíos-sobre-tuplas">Desafíos sobre tuplas<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-tuplas"></a></h3>
<ul><li><p>¿Qué sucede cuando ejecutas <code>a_list[1] = 5</code>?</p></li>
<li>
<p>¿Qué sucede cuando ejecutas <code>a_tuple[2] = 5</code>?</p>
<p>Como <code>tuple</code> es inmutable, no soporta asignación de ítems.
Los elementos de <code>list</code> pueden ser alterados
individualmente.</p>
</li>
<li>
<p>¿Qué te dice <code>type(a_tuple)</code> sobre
<code>a_tuple</code>?</p>
<p><code>tuple</code></p>
</li>
</ul></div>
<div class="section level3">
<h3 id="desafíos-sobre-diccionarios">Desafíos sobre diccionarios<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-diccionarios"></a></h3>
<ul><li>Cambiando diccionarios: 2. Reasigna el segundo valor.</li>
</ul><p>Asegúrate también de aclarar que acceder al “segundo valor” se trata
del nombre de la clave. Agrega por ejemplo <code>rev[10] = "ten"</code>
para aclarar que no se trata de la posición.</p>
<pre><code><span><span class="va">rev</span></span></code></pre>
<p>{: .language-python} ~~~ {1: ‘one’, 2: ‘two’, 3: ‘three’} ~~~ {:
.output}</p>
<pre><code><span><span class="va">rev</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">=</span> <span class="st">"apple-sauce"</span></span></code></pre>
<p>{: .language-python}</p>
<pre><code>{1: 'one', 2: 'apple-sauce', 3: 'three'}</code></pre>
<p>{: .output}</p>
</div>
</div>
<div class="section level2">
<h2 id="starting-with-data">02-starting-with-data<a class="anchor" aria-label="anchor" href="#starting-with-data"></a></h2>
<div class="section level3">
<h3 id="nota-sobre-bugs">Nota sobre bugs<a class="anchor" aria-label="anchor" href="#nota-sobre-bugs"></a></h3>
<p>Pandas &lt; .18.1 tiene un error <strong>bug</strong> por el cual
<code>surveys_df['weight'].describe()</code> puede devolver un error en
tiempo de ejecución.</p>
</div>
<div class="section level3">
<h3 id="desafíos-sobre-dataframes">Desafíos sobre DataFrames<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-dataframes"></a></h3>
<ul><li>
<p><code>surveys_df.columns</code></p>
<p>Nombres de columnas. (Opcional: muestra
<code>surveys_df.columns[4] = "plotid"</code>. El índice no es mutable;
recapitula del episodio anterior. La adaptación del nombre es realizada
por la función <code>rename</code>:
<code>surveys_df.rename(columns={"plot_id": "plotid"})</code>)</p>
</li>
<li>
<p><code>surveys_df.head()</code>. Además, ¿qué realiza
<code>surveys_df.head(15)</code>?</p>
<p>Muestra las primeras 5 líneas. Muestra las primeras 15
líneas.</p>
</li>
<li>
<p><code>surveys_df.tail()</code></p>
<p>Muestra las últimas 15 líneas.</p>
</li>
<li>
<p><code>surveys_df.shape</code>. Toma nota de la salida de
<code>shape</code> - ¿Qué formato tiene la salida del atributo que
regresa la forma de un DataFrame?</p>
<p><code>type(surveys_df.shape)</code> -&gt; <code>Tuple</code></p>
</li>
</ul></div>
<div class="section level3">
<h3 id="desafíos-sobre-calcular-estadísticas-de-los-datos">Desafíos sobre calcular estadísticas de los datos<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-calcular-estad%C3%ADsticas-de-los-datos"></a></h3>
<ul><li>
<p>Crear una lista de los IDs de los sitios <code>plot_id</code> que
están en los datos de la encuesta <code>surveys_df</code>. Llamemos a
esta lista <code>site_names</code>. ¿Cuántos sitios hay en los datos?,
¿cuántas especies hay en los datos?</p>
<p><code>plot_names = pd.unique(surveys_df["plot_id"])</code>. Número de
IDs de los sitios: <code>plot_names.size</code> o
<code>len(plot_names)</code>. Número de especies en los datos:
<code>len(pd.unique(surveys_df["species"]))</code></p>
</li>
<li><p>¿Cuál es la diferencia entre <code>len(plot_names)</code> y
<code>surveys_df['plot_id'].nunique()</code>?</p></li>
</ul><p>Ambos resultan en el mismo output, sirviendo como formas alternativas
de obtener los valores únicos. <code>nunique</code> combina el conteo
con la extracción de valores únicos.</p>
</div>
<div class="section level3">
<h3 id="desafíos-sobre-agrupamientos">Desafíos sobre agrupamientos<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-agrupamientos"></a></h3>
<ul><li>
<p>¿Cuántas observaciones son de sexo femenino <code>F</code> y
cuántas de sexo masculino <code>M</code>?</p>
<p><code>grouped_data.count()</code></p>
</li>
<li>
<p>¿Qué pasa cuando agrupas sobre dos columnas usando el siguiente
enunciado y después tomas los valores medios?</p>
<p>Se calcula el valor medio para cada combinación de
<code>plot_id</code> y <code>sex</code>. Remarca que la media no tiene
sentido para cada variable, así que puedes especificarla por columna:
por ejemplo, si deseas conocer el último año censado, la mediana de las
longitudes de pies y el valor medio del peso para cada combinación de
<code>plot</code> y <code>sex</code>:</p>
</li>
</ul><pre><code>surveys_df.groupby(['plot_id','sex']).agg({"year": 'min',
                                           "hindfoot_length": 'median',
                                           "weight": 'mean'})`</code></pre>
<p>{: .language-python}</p>
<ul><li>Calcula las estadísticas descriptivas del peso <code>weight</code>
para cada <code>plot_id</code>.</li>
</ul><pre><code>surveys_df.groupby(['plot_id'])['weight'].describe()</code></pre>
<p>{: .language-python}</p>
<ul><li>
<p>¿Qué otra manera hay de crear una lista de especies y asociarle
el número <code>count</code> de las muestras de los datos?</p>
<p>En vez de recuperar y luego contar las columnas resultantes de
<code>groupby</code>, también puedes hacer el recuento junto con
<code>groupby</code> (en todas las columnas) y construir una selección
del <code>DataFrame</code> resultante:
<code>surveys_df.groupby('species_id').count()["record_id"]</code></p>
</li>
</ul></div>
<div class="section level3">
<h3 id="desafíos-sobre-gráficos">Desafíos sobre gráficos<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-gr%C3%A1ficos"></a></h3>
<ul><li>Crea un gráfico del promedio de peso de las especies por sitio.</li>
</ul><pre><code>surveys_df.groupby('plot_id').mean()["weight"].plot(kind='bar')</code></pre>
<p>{: .language-python}</p>
<figure><img src="../fig/01_chall_bar_meanweight.png" alt="" class="figure mx-auto d-block"><figcaption>promedio de peso de las especies por sitio</figcaption></figure><ul><li>Crea una gráfica del total de machos contra el total de hembras para
todo el dataset.</li>
</ul><pre><code>surveys_df.groupby('sex').count()["record_id"].plot(kind='bar')</code></pre>
<figure>{: .language-python} <img src="../fig/01_chall_bar_totalsex.png" alt="total de machos contra el total de hembras para todo el dataset" class="figure mx-auto d-block"></figure></div>
</div>
<div class="section level2">
<h2 id="index-slice-subset">03-index-slice-subset<a class="anchor" aria-label="anchor" href="#index-slice-subset"></a></h2>
<p>Sugerencia: usa el método <code>.head()</code> a lo largo de esta
lección con el fin de mantener tu pantalla limpia. Anima a las
estudiantes a probar comandos con y sin <code>.head()</code> para
reforzar la utilidad de esta herramienta y luego emplearla, o no, según
su preferencia. Por ejemplo, si una estudiante muestra preocupación por
mantener el ritmo de tipeo, infórmale que puede evitar
<code>.head()</code>, pero que tú lo usarás para mantener visibles más
líneas anteriores de código.</p>
<div class="section level3">
<h3 id="desafíos-sobre-indexación">Desafíos sobre indexación<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-indexaci%C3%B3n"></a></h3>
<ul><li>
<p>¿Qué valor devuelve el siguiente código? <code>a[0]</code></p>
<p><code>1</code>, ya que Python comienza por el elemento 0 (para
usuarios de Matlab: ¡esto es diferente!)</p>
</li>
<li>
<p>¿Qué valor devuelve éste? <code>a[5]</code></p>
<p><code>IndexError</code></p>
</li>
<li>
<p>En el ejemplo anterior, llamar a <code>a [5]</code> devuelve un
error. ¿Por qué?</p>
<p>La lista no tiene ningún elemento con índice 5 (va de 0 a
4).</p>
</li>
<li>
<p>¿Qué tal éste? <code>a[len(a)]</code></p>
<p><code>IndexError</code></p>
</li>
</ul></div>
<div class="section level3">
<h3 id="desafíos-sobre-rangos">Desafíos sobre rangos<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-rangos"></a></h3>
<ul><li>
<p>¿Qué ocurre al ejecutar el siguiente código?</p>
<p><code>surveys_df[0:1]</code> selecciona sólo el primer elemento
<code>surveys_df[:4]</code> seleccionar desde el primer elemento hace
redundante escribir el 0 <code>surveys_df[-1:]</code> puedes contar
hacia atrás</p>
<p><em>Sugerencia</em>: También puedes seleccionar cada N-ésima fila:
<code>surveys_df[1:10:2]</code>. Entonces, ¿cómo interpretas
<code>surveys_df[::-1]</code>?</p>
</li>
<li>
<p>¿Qué pasa al ejecutar este otro?:
<code>surveys_df.iloc[0:4, 1:4]</code> y
<code>surveys_df.loc[0:4, 1:4]</code>? ¿Qué diferencia observas entre
los resultados de los comandos inmediatamente anteriores?</p>
<p>Revisa la posición, o el nombre. La segunda opción se asemeja a
consultar un diccionario por nombres de llaves. Los nombres de columnas
1:4 no existen, resultando en un error. Revisa también la diferencia
entre <code>surveys_df.loc[0:4]</code> y
<code>surveys_df.iloc[0:4]</code></p>
</li>
</ul></div>
<div class="section level3">
<h3 id="desafíos-avanzados-sobre-queries">Desafíos avanzados sobre <strong>queries</strong>
<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-avanzados-sobre-queries"></a></h3>
<ul><li>
<p>Selecciona un subconjunto de filas, en el <code>DataFrame</code>
<code>surveys_df</code>, que contenga datos desde el año 1999 y que
contenga valores en <code>weight</code> menores o iguales a 8. ¿Cuántas
filas obtuviste como resultado? ¿Cuántas filas obtuvo tu compañera?</p>
<p><code>surveys_df[(surveys_df["year"] == 1999) &amp; (surveys_df["weight"] &lt;= 8)]</code>;
cuándo sólo te interesa el número final, también puede utilizarse la
suma de valores <code>True</code>:
<code>sum((surveys_df["year"] == 1999) &amp; (surveys_df["weight"] &lt;= 8))</code></p>
</li>
<li>
<p>Puedes usar la función <code>isin</code> de Python para hacer una
consulta, a un <code>DataFrame</code>, basada en una lista de valores
según se muestra a continuación:
<code>surveys_df[surveys_df['species_id'].isin([listGoesHere])]</code>.
Usa la función <code>isin</code> para encontrar todos los
<code>plots</code> que contienen una especie en particular en el
<code>DataFrame</code> <code>surveys_df</code>. ¿Cuántos registros
contienen esos valores?</p>
<p>Por ejemplo, usa <code>PB</code> y <code>PL</code>:
<code>surveys_df[surveys_df['species_id'].isin(['PB', 'PL'])]['plot_id'].unique()</code>
provee una lista de todos los gráficos en los que están involucradas
estas especies. Con
<code>surveys_df[surveys_df['species_id'].isin(['PB', 'PL'])].shape</code>
se puede obtener el número de registros.</p>
</li>
<li>
<p>Experimenta con otras consultas. Crea una consulta que encuentre
todas las filas con el valor de <code>weight</code> mayor o igual a
0.</p>
<p><code>surveys_df[surveys_df["weight"] &gt;= 0]</code></p>
<p><em>Sugerencia</em>: Puedes presentar aquí que todas estas
operaciones de segmentación se basan realmente en operaciones de
<em>indexado booleano</em> (la siguiente sección en esta lección). El
filtrado indica para cada registro si éste satisface (<code>True</code>)
o no (<code>False</code>) una condición. La segmentación se realiza por
interpretación del valor <code>True</code>/<code>Falso</code> de cada
registro.</p>
</li>
<li><p>El símbolo <code>~</code> en Python puede ser usado para obtener
lo <strong>opuesto</strong> a los datos seleccionados que hayas
especificado en Python. Es equivalente a <strong>no esta en</strong>.
Escribe una consulta que seleccione todas las filas con <code>sex</code>
diferente de ‘M’ o ‘F’ en los datos de <code>surveys</code>.</p></li>
</ul><pre><code>surveys_df[~surveys_df["sex"].isin(['M', 'F'])]</code></pre>
<p>{: .language-python}</p>
</div>
<div class="section level3">
<h3 id="desafíos-sobre-máscaras">Desafíos sobre máscaras<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-m%C3%A1scaras"></a></h3>
<ul><li>Crea un nuevo objeto <code>DataFrame</code> que solamente contenga
observaciones cuyos valores en la columna <code>sex</code>
<strong>no</strong> sean <code>female</code> o <code>male</code>. Asigna
cada valor de <code>sex</code> en el nuevo <code>DataFrame</code> a un
nuevo valor de ‘x’. Determina el número total de valores
<code>null</code> en el subconjunto.</li>
</ul><pre><code>new = surveys_df[~surveys_df['sex'].isin(['M', 'F'])].copy()
new['sex']='x'
print(len(new))</code></pre>
<p>{: .language-python}</p>
<p>Puedes verificar el número de valores Nan con
<code>sum(surveys_df['sex'].isnull())</code>, que resulta igual al
número de registros que no son <code>female</code> ni
<code>male</code>.</p>
<ul><li>Crea un nuevo objeto <code>DataFrame</code> que contenga solo
observaciones cuyos valores en la columna <code>sex</code> sean
<code>male</code> o <code>female</code> y en los cuales el valor de
<code>weight</code> sea mayor que 0. Luego, crea un gráfico de barra
apiladas del promedio de <code>weight</code>, por parcela, con valores
<code>male</code> versus <code>female</code> apilados por cada
parcela.</li>
</ul><pre><code># selecciona los datos con isin:
stack_selection = surveys_df[(surveys_df['sex'].isin(['M', 'F'])) &amp;
							surveys_df["weight"] &gt; 0.][["sex", "weight", "plot_id"]]
# calcula el promedio de weight para cada combinación de plot_id y sex:
stack_selection = stack_selection.groupby(["plot_id", "sex"]).mean().unstack()
# podemos representarlo como un gráfico de barras apiladas:
stack_selection.plot(kind='bar', stacked=True)</code></pre>
<p>{: .language-python}</p>
<p><em>Sugerencia</em>: Como sabemos que todos los otros valores son
Nan, podemos seleccionar también todos los valores que no sean
<code>null</code> (esto es sólo un vistazo previo, habrá más al respecto
en la siguiente lección): ~~~ stack_selection =
surveys_df[(surveys_df[‘sex’].notnull()) &amp; surveys_df[“weight”] &gt;
0.][[“sex”, “weight”, “plot_id”]] ~~~ {: .language-python}</p>
<figure><img src="../fig/02_chall_stack_levelissue.png" alt="" class="figure mx-auto d-block"><figcaption>promedio de weight para cada plot por sex</figcaption></figure><p>Sin embargo, debido al comando <code>unstack</code>, el encabezado de
la leyenda contiene dos niveles. Para removerlo, los nombres de columnas
deben ser simplificados: ~~~ stack_selection.columns =
stack_selection.columns.droplevel() ~~~ {: .language-python}</p>
<figure><img src="../fig/02_chall_stack_level.png" alt="" class="figure mx-auto d-block"><figcaption>promedio de <code>weight</code> para cada
<code>plot_id</code> por <code>sex</code></figcaption></figure></div>
</div>
<div class="section level2">
<h2 id="data-types-and-format">04-data-types-and-format<a class="anchor" aria-label="anchor" href="#data-types-and-format"></a></h2>
<div class="section level3">
<h3 id="desafíos-sobre-cambiar-tipos">Desafíos sobre cambiar tipos<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-cambiar-tipos"></a></h3>
<ul><li>Intenta convertir la columna <code>plot_id</code> a
<strong>float</strong> usando
<code>surveys_df.plot_id.astype("float")</code>. A continuación, intenta
convertir <code>weight</code> (peso) en un <strong>integer</strong>.
¿Qué te dice Pandas? ¿Qué es lo que va mal ahí?</li>
</ul><p>Pandas no puede convertir datos de tipo <strong>float</strong> a
<strong>int</strong> si la columna contiene valores NaN.</p>
</div>
<div class="section level3">
<h3 id="desafíos-sobre-cuentas">Desafíos sobre cuentas<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-cuentas"></a></h3>
<ul><li>Cuenta el número de valores perdidos por columna. Sugerencia: el
método <code>.count()</code> te proporciona el número de observaciones
que no son NA por columna. Examina el método
<code>.isnull()</code>.</li>
</ul><pre><code><span><span class="fu">surveys_df.isnull</span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>{: .language-python}</p>
<p>Si las estudiantes tienen problemas para generar el output, u ocurre
algo con éste, existe un archivo llamado “sample output” con los datos
que ellas deben generar.</p>
</div>
</div>
<div class="section level2">
<h2 id="merging-data">05-merging-data<a class="anchor" aria-label="anchor" href="#merging-data"></a></h2>
<ul><li>En la carpeta de datos, hay dos archivos de datos de encuestas:
<code>survey2001.csv</code> y <code>survey2002.csv</code>. Lee los datos
en Python y combina los archivos para hacer un DataFrame nuevo. Crea una
gráfica del peso promedio de la parcela, <code>plot_id</code>, por año
agrupada por <code>sex</code>. Exporta tus resultados como CSV y
asegúrate de que se lean correctamente en Python..</li>
</ul><pre><code># lee los archivos:
survey2001 = pd.read_csv("data/survey2001.csv")
survey2002 = pd.read_csv("data/survey2002.csv")
# concatena los archivos:
survey_all = pd.concat([survey2001, survey2002], axis=0)
# recupera el peso de cada año, agrupado por sexo:
weight_year = survey_all.groupby(['year', 'sex']).mean()["wgt"].unstack()
# genera el gráfico:
weight_year.plot(kind="bar")
plt.tight_layout()  # tip(!)</code></pre>
<figure>{: .language-python} <img src="../fig/04_chall_weight_year.png" alt="peso promedio por año, agrupado por sexo" class="figure mx-auto d-block"> ~~~ # escribe a un
archivo: weight_year.to_csv(“weight_for_year.csv”) # lee los datos de
nuevo: pd.read_csv(“weight_for_year.csv”, index_col=0) ~~~ {:
.language-python}</figure><ul><li>Cree un nuevo DataFrame uniendo los contenidos de las tablas
<code>surveys.csv</code> y <code>species.csv</code>.</li>
</ul><pre><code><span><span class="va">merged_left</span> <span class="op">=</span> <span class="fu">pd.merge</span><span class="op">(</span>left<span class="op">=</span><span class="va">surveys_df</span>,right<span class="op">=</span><span class="va">species_df</span>, how<span class="op">=</span><span class="st">'left'</span>, on<span class="op">=</span><span class="st">"species_id"</span><span class="op">)</span></span></code></pre>
<p>{: .language-python}</p>
<p>Luego calcula y crea un gráfico de la distribución de:</p>
<p><strong>1. taxa por parcela</strong> (número de especies de cada taxa
por parcela):</p>
<p>La distribución de especies (número de taxa por cada parcela) puede
calcularse de la siguiente forma: ~~~
merged_left.groupby([“plot_id”])[“taxa”].nunique().plot(kind=‘bar’) ~~~
{: .language-python}</p>
<figure><img src="../fig/04_chall_ntaxa_per_site.png" alt="" class="figure mx-auto d-block"><figcaption>taxa por parcela</figcaption></figure><p><em>Sugerencia</em>: También es posible graficar el número de
invididuos de cada taxa en cada parcela (gráfico de barras apiladas):
~~~ merged_left.groupby([“plot_id”,
“taxa”]).count()[“record_id”].unstack().plot(kind=‘bar’, stacked=True)
plt.legend(loc=‘upper center’, ncol=3, bbox_to_anchor=(0.5, 1.05)) ~~~
{: .language-python} (de otro modo, la leyenda se superpone con el
gráfico de barras)</p>
<figure><img src="../fig/04_chall_taxa_per_site.png" alt="" class="figure mx-auto d-block"><figcaption>taxa por parcela</figcaption></figure><p><strong>2. taxa por sexo por parcela</strong>: Otorguemos los valores
‘M|F’ a los valores Nan (también podrían cambiarse a ‘x’): ~~~
merged_left.loc[merged_left[“sex”].isnull(), “sex”] = ‘M|F’ ~~~ {:
.language-python}</p>
<p>Número de taxa por cada combinación de parcela/sexo: ~~~
ntaxa_sex_site= merged_left.groupby([“plot_id”,
“sex”])[“taxa”].nunique().reset_index(level=1) ntaxa_sex_site =
ntaxa_sex_site.pivot_table(values=“taxa”, columns=“sex”,
index=ntaxa_sex_site.index) ntaxa_sex_site.plot(kind=“bar”,
legend=False) plt.legend(loc=‘upper center’, ncol=3,
bbox_to_anchor=(0.5, 1.08), fontsize=‘small’, frameon=False) ~~~ {:
.language-python}</p>
<figure><img src="../fig/04_chall_ntaxa_per_site_sex.png" alt="" class="figure mx-auto d-block"><figcaption>taxa por parcela por sexo</figcaption></figure><p><em>Sugerencia (sólo para discutir))</em>:</p>
<p>También puede calcularse el número de individuos de cada taxa en cada
parcela y por sexo:</p>
<pre><code>sex_taxa_site  = merged_left.groupby(["plot_id", "taxa", "sex"]).count()['record_id']
sex_taxa_site.unstack(level=[1, 2]).plot(kind='bar', logy=True)
plt.legend(loc='upper center', ncol=3, bbox_to_anchor=(0.5, 1.15),
           fontsize='small', frameon=False)</code></pre>
<p>{: .language-python}</p>
<figure><img src="../fig/04_chall_sex_taxa_site_intro.png" alt="" class="figure mx-auto d-block"><figcaption>taxa por parcela por sexo</figcaption></figure><p>En verdad, éste gráfico no es el mejor que podría elegirse, pues no
es legible… Una primera alternativa para mejorarlo es utilizar
<strong>facets</strong>. Sin embargo, pandas/matplotlib no los provee
por defecto. Un ejemplo en matplotlib puro (usando <code>M|F</code> para
registros sin sexo definido):</p>
<pre><code>fig, axs = plt.subplots(3, 1)
for sex, ax in zip(["M", "F", "M|F"], axs):
    sex_taxa_site[sex_taxa_site["sex"] == sex].plot(kind='bar', ax=ax, legend=False)
    ax.set_ylabel(sex)
    if not ax.is_last_row():
        ax.set_xticks([])
        ax.set_xlabel("")
axs[0].legend(loc='upper center', ncol=5, bbox_to_anchor=(0.5, 1.3),
              fontsize='small', frameon=False)</code></pre>
<p>{: .language-python}</p>
<figure><img src="../fig/04_chall_sex_taxa_site.png" alt="" class="figure mx-auto d-block"><figcaption>taxa por parcela por sexo</figcaption></figure><p>Sin embargo, sería mejor indicar <a href="https://stanford.edu/~mwaskom/software/seaborn/" class="external-link">Seaborn</a> y <a href="https://github.com/ellisonbg/altair" class="external-link">Altair</a> por sus tipos de
visualizaciones multivariadas.</p>
<ul><li>En la carpeta de datos, hay un archivo <code>plots.csv</code> que
contiene información sobre el tipo asociado con cada parcela. Usa esos
datos para resumir el número de parcelas por tipo de parcela.</li>
</ul><pre><code>plot_info = pd.read_csv("data/plots.csv")
plot_info.groupby("plot_type").count()</code></pre>
<p>{: .language-python}</p>
<ul><li>Calcula un índice de diversidad de su elección para control vs
parcelas de rodamiento de roedores. El índice debe considerar tanto la
abundancia de especies como el número de especies. Puedes optar por
utilizar el simple <a href="http://www.amnh.org/explore/curriculum-collections/biodiversity-counts/plant-ecology/how-to-calculate-a-biodiversity-index" class="external-link">índice
de biodiversidad descrito aquí</a> que calcula la biodiversidad como:
<code>el número de especies en la parcela / el número total de individuos en la parcela = índice de biodiversidad.</code>
</li>
</ul><pre><code>merged_site_type = pd.merge(merged_left, plot_info, on='plot_id')
# para cada parcela, recupera el número de especies por parcela
nspecies_site = merged_site_type.groupby(["plot_id"])["species"].nunique().rename("nspecies")
# para cada parcela, recupera el número de individuos
nindividuals_site = merged_site_type.groupby(["plot_id"]).count()['record_id'].rename("nindiv")
# combina las dos series
diversity_index = pd.concat([nspecies_site, nindividuals_site], axis=1)
# calcula el índice de diversidad
diversity_index['diversity'] = diversity_index['nspecies']/diversity_index['nindiv']</code></pre>
<p>{: .language-python}</p>
<p>Generando un gráfico de barras:</p>
<pre><code>diversity_index['diversity'].plot(kind="barh")
plt.xlabel("Diversity index")</code></pre>
<p>{: .language-python}</p>
<figure><img src="../fig/04_chall_diversity_index.png" alt="" class="figure mx-auto d-block"><figcaption>taxa por parcela por sexo</figcaption></figure></div>
<div class="section level2">
<h2 id="loops-and-functions">06-loops-and-functions<a class="anchor" aria-label="anchor" href="#loops-and-functions"></a></h2>
<div class="section level3">
<h3 id="desafíos-sobre-bucles-básicos">Desafíos sobre bucles básicos<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-bucles-b%C3%A1sicos"></a></h3>
<ul><li>
<p>¿Qué pasa si no incluimos la palabra clave <code>pass</code>?</p>
<p><code>SyntaxError:</code></p>
</li>
<li><p>Reescribe el bucle de tal forma que los animales estén separados
por comas y no por una línea nueva. (Pista: Puedes concatenar cadenas de
caracteres usando el signo más. Por ejemplo,
<code>print(string1 + string2)</code> resulta en
‘string1string2’).</p></li>
</ul><pre><code>for creature in animals:
    print(creature+',', end='')</code></pre>
<p>{: .language-python}</p>
<p>Este bucle también agrega una coma luego del último animal. Una
solución mejor, sin bucles, sería: <code>','.join(animals)</code></p>
</div>
<div class="section level3">
<h3 id="desafíos-sobre-modificación-de-bucles">Desafíos sobre modificación de bucles<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-modificaci%C3%B3n-de-bucles"></a></h3>
<ul><li>Algunas de las encuestas que guardaste tienen datos faltantes
(tienen valores nulos que salen como <code>NaN</code> - No es un número
(en inglés) - en los DataFrames y no salen en los archivos de texto).
Modifica el bucle <strong>for</strong> para que las entradas que tengan
valores nulos no sean incluidas en los archivos anuales.</li>
</ul><pre><code>surveys_year = surveys_df[surveys_df.year == year].dropna()</code></pre>
<p>{: .language-python}</p>
<ul><li>Supongamos que solo quieres revisar los datos cada cierto múltiplo
de años. ¿Cómo modificarías el bucle para generar un archivo de datos
cada cinco años comenzando desde 1977?</li>
</ul><p>Aunque podrías hacer la lista manualmente, ¿por qué no recuperas el
primer y el último año a partir del código?</p>
<pre><code>n_year = 5  # mejor visión general si defines una variable
first_year = surveys_df['year'].min()
last_year = surveys_df['year'].max()

for year in range(first_year, last_year, n_year):
    print(year)

    # Selecciona los datos para los años correctos
    surveys_year = surveys_df[surveys_df.year == year].dropna()</code></pre>
<p>{: .language-python}</p>
<ul><li>En vez de separar la información por años, un colega tuyo quiere
hacer el análisis separando por especies. ¿Cómo escribirías un único
archivo CSV por cada especie?</li>
</ul><p>De forma similar al ejemplo anterior, pero usando la columna
<code>species_id</code>: <code>surveys_df['species_id'].unique()</code>.
Sin embargo, usar los nombres de especies mejoraría la interpretación de
los nombres de archivos. Un <code>join</code> con las especies:
<code>merged_left = pd.merge(left=surveys,right=species, how='left', on="species_id")</code>
y usando la columna <code>species</code>.</p>
</div>
<div class="section level3">
<h3 id="desafíos-sobre-funciones">Desafíos sobre funciones<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-funciones"></a></h3>
<ul><li>Cambia los valores de los argumentos en la función y mira su
salida.</li>
<li>Intenta llamar a la función usando la cantidad equivocada de
argumentos (es decir, diferente de 2) o sin asignar la llamada de la
función a una variable (sin poner
<code>product_of_inputs =</code>).</li>
<li>Declara una variable dentro de una función y prueba a encontrar en
dónde existe (Pista: ¿puedes imprimirla desde fuera de la función?)</li>
<li>Explora qué sucede cuando una variable tiene el mismo nombre adentro
y afuera de la función. ¿Qué le ocurre a la variable global cuando
cambias el valor de la variable local?</li>
</ul><p>Para mayor claridad, ¡demuéstralo en un entorno de
<strong>debugging</strong>!</p>
</div>
<div class="section level3">
<h3 id="desafíos-adicionales-sobre-funciones">Desafíos adicionales sobre funciones<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-adicionales-sobre-funciones"></a></h3>
<ul><li>Añade dos argumentos a las funciones que escribimos que tomen el
<strong>path</strong> del directorio donde los archivos serán escritos y
el root del nombre del archivo. Crea un nuevo conjunto de archivos con
un nombre diferente en un directorio diferente.</li>
</ul><pre><code>def one_year_csv_writer(this_year, all_data, folder_to_save, root_name):
    """
    Escribe un archivo csv para los datos de un año dado.

    Parámetros
    ---------
    this_year : int
        año para el cual se extraen datos
    all_data: pd.DataFrame
        DataFrame con datos de múltiples años
    folder_to_save : str
        carpeta para guardar los archivos de datos
    root_name: str
        raíz de los nombres de archivo donde se guardan los datos
    """

    # Selecciona datos para el año
    surveys_year = all_data[all_data.year == this_year]

    # Escribe el nuevo DataFrame a un archivo csv
    filename = os.path.join(folder_to_save, ''.join([root_name, str(this_year), '.csv']))
    surveys_year.to_csv(filename)</code></pre>
<p>{: .language-python} También adapta la función
<code>yearly_data_csv_writer</code> con los <strong>inputs</strong>
adicionales.</p>
<ul><li>¿Cómo podrías usar la función <code>yearly_data_csv_writer</code>
para crear un archivo CSV para solo un año? (Pista: piensa sobre la
sintaxis para <code>range</code>)</li>
</ul><p>Adapta los argumentos de entrada, por ejemplo: 1978, 1979.</p>
</div>
<div class="section level3">
<h3 id="desafíos-sobre-manejo-de-output">Desafíos sobre manejo de output<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-manejo-de-output"></a></h3>
<ul><li>Haz que las funciones retornen una lista de los archivos que
escribieron. Hay muchas formas en las que puedes hacer esto (¡y deberías
intentarlas todas!):
<ul><li>cualquiera de las dos funciones podría imprimir algo en pantalla,
Sólo agrega el comando
<code>print("year " + str(this_year)+ " written to disk")</code>
</li>
<li>cualquiera podría usar <code>return</code> para retornar números o
cadenas de caracteres cada vez que se llaman,</li>
<li>o podrías hacer una combinación de estas dos estrategias.</li>
<li>Podrías también intentar usar la librería <code>os</code> para
listar los contenidos de directorios. <code>os.listdir</code>
</li>
</ul></li>
</ul><p>Implementación dentro de la función: ~~~ filenames = [] for year in
range(start_year, end_year+1):
filenames.append(one_year_csv_writer(year, all_data, folder_to_save,
root_name)) return filenames ~~~ {: .language-python}</p>
<ul><li><p>Explora qué sucede cuando las variables son declaradas dentro de
cada una de las funciones versus en el cuerpo principal de tu código (lo
que está sin indentar). ¿Cuál es el alcance de las variables (es decir,
dónde son visibles)?, ¿qué ocurre si tienen el mismo nombre pero valores
diferentes?</p></li>
<li><p>¿Qué tipo de objeto corresponde a una variable declarada como
<code>None</code>? (Pista: crea una variable con el valor
<code>None</code> y usa la función <code>type()</code>)</p></li>
</ul><pre><code><span><span class="va">NoneType</span></span></code></pre>
<p>{: .output}</p>
<ul><li><p>Compara el comportamiento de la función
<code>yearly_data_arg_test</code> cuando los argumentos tienen
<code>None</code> como valor por defecto y cuando no tienen valores por
defecto.</p></li>
<li><p>¿Qué ocurre si solo incluimos un valor para
<code>start_year</code> al llamar a la función?, ¿puedes escribir una
llamada a la función con solo un valor para <code>end_year</code>?
(Pista: piensa en cómo la función debe estar asignándole valores a cada
uno de sus argumentos - ¡esto está relacionado con la necesidad de poner
los argumentos que no tienen valores por defecto antes de los que sí
tienen valores por defecto en la definición de la función!)</p></li>
</ul><pre><code><span><span class="fu">yearly_data_arg_test</span><span class="op">(</span><span class="va">surveys_df</span>, end_year<span class="op">=</span><span class="fl">2001</span><span class="op">)</span></span></code></pre>
<p>{: .language-python}</p>
</div>
<div class="section level3">
<h3 id="desafíos-sobre-modificación-de-funciones">Desafíos sobre modificación de funciones<a class="anchor" aria-label="anchor" href="#desaf%C3%ADos-sobre-modificaci%C3%B3n-de-funciones"></a></h3>
<ul><li>Reescribe las funciones <code>one_year_csv_writer</code> y
<code>yearly_data_csv_writer</code> para que tengan argumentos keyword
con valores por defecto.</li>
</ul><pre><code>def one_year_csv_writer(this_year, all_data, folder_to_save='./', root_name='survey'):
    """
    Escribe un archivo csv para los datos de un año dado.

    Parámetros
    ---------
    this_year : int
        año para el cual se extraen datos
    all_data: pd.DataFrame
        DataFrame con datos de múltiples años
    folder_to_save : str
        carpeta para guardar los archivos de datos
    root_name: str
        raíz de los nombres de archivo donde se guardan los datos
    """

    # Selecciona datos para el año
    surveys_year = all_data[all_data.year == this_year]

    # Escribe el nuevo DataFrame a un archivo csv
    filename = os.path.join(folder_to_save, ''.join([root_name, str(this_year), '.csv']))
    surveys_year.to_csv(filename)</code></pre>
<p>{: .language-python}</p>
<ul><li>Modifica las funciones de tal forma que no creen archivos para un
año si éste no está en los datos y que muestre una alerta al usuario
(Pista: usa condicionales para esto. Si quieres un reto más, ¡usa
<code>try</code>!)</li>
</ul><pre><code>    # Escribe el nuevo DataFrame a un archivo csv
    if len(surveys_year) &gt; 0:
        filename = os.path.join(folder_to_save, ''.join([root_name, str(this_year), '.csv']))
        surveys_year.to_csv(filename)
    else:
        print("No data for year " + str(this_year))</code></pre>
<p>{: .language-python}</p>
<ul><li>El código que has escrito hasta este momento usando el bucle
<strong>for</strong> está bastante bien, pero no necesariamente es
reproducible con <strong>datasets</strong> diferentes. Por ejemplo, ¿qué
pasa con el código si tenemos datos para más años? Usando las
herramientas que aprendiste en las actividades anteriores, crea una
lista de todos los años representados en los datos. Después crea un
bucle para procesar tu información, comenzando desde el primer año y
terminando en el último usando la lista.</li>
</ul><pre><code>def yearly_data_csv_writer(all_data, yearcolumn="year",
                           folder_to_save='./', root_name='survey'):
    """
    Escribe archivos csv separados para los datos de cada año.

    all_data --- DataFrame con datos de múltiples años
    yearcolumn --- nombre de columna con el año de los datos
    folder_to_save --- carpeta para guardar los archivos de datos
    root_name --- inicio de los nombres de archivo almacenados
    """
    years = all_data["year"].unique()

    # "end_year" es el último año de los datos que queremos extraer, así que hacemos un bucle hasta end_year+1
    filenames = []
    for year in years:
        filenames.append(one_year_csv_writer(year, all_data, folder_to_save, root_name))
    return filenames</code></pre>
<p>{: .language-python}</p>
</div>
</div>
<div class="section level2">
<h2 id="visualization-ggplot-python">07-visualization-ggplot-python<a class="anchor" aria-label="anchor" href="#visualization-ggplot-python"></a></h2>
<p>Si las estudiantes tienen problemas para generar el output, u ocurre
algo con éste, existe un archivo llamado “sample output” con los datos
que ellas debían generar en la lección 03.</p>
<p>Las <strong>notebooks</strong> de iPython para graficar pueden verse
en la carpeta <code>_extras</code></p>
</div>
<div class="section level2">
<h2 id="putting-it-all-together">08-putting-it-all-together<a class="anchor" aria-label="anchor" href="#putting-it-all-together"></a></h2>
<p>Las científicas suelen operar sobre ecuaciones matemáticas. La
capacidad para usar estas ecuaciones en sus gráficas otorga mucho valor
agregado. Por fortuna, Matplotlib provee herramientas poderosas para el
control de texto. Una de ellas es la capacidad para usar la notación
matemática de LaTeX al usar texto (puedes aprender más sobre la notación
matemática de LaTeX aquí: <a href="https://en.wikibooks.org/wiki/LaTeX/Mathematics" class="external-link uri">https://en.wikibooks.org/wiki/LaTeX/Mathematics</a>). Para
usar notación matemática, enciera tu texto con el signo <code>$</code>.
LaTeX usa mucho el caracter de barra invertida o
<strong>backlash</strong> (“\”). Como este caracter tiene un significado
especial en las secuencias de caracteres de Python, deberían
reemplazarse todas las barras invertidas relacionadas con LaTeX por dos
barras invertidas.</p>
<pre><code><span><span class="fu">plt.plot</span><span class="op">(</span><span class="va">t</span>, <span class="va">t</span>, <span class="st">'r--'</span>, label<span class="op">=</span><span class="st">'$y=x$'</span><span class="op">)</span></span>
<span><span class="fu">plt.plot</span><span class="op">(</span><span class="va">t</span>, <span class="va">t</span><span class="op">**</span><span class="fl">2</span> , <span class="st">'bs-'</span>, label<span class="op">=</span><span class="st">'$y=x^2$'</span><span class="op">)</span></span>
<span><span class="fu">plt.plot</span><span class="op">(</span><span class="va">t</span>, <span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="fl">5</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">5</span> <span class="op">*</span> <span class="va">t</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="st">'g^:'</span>, label<span class="op">=</span><span class="st">'$y=(x - 5)^2 + 5  x - \\frac{1}{2}$'</span><span class="op">)</span> <span class="co"># nota la barra invertida doble</span></span>
<span></span>
<span><span class="fu">plt.legend</span><span class="op">(</span>loc<span class="op">=</span><span class="st">'upper left'</span>, shadow<span class="op">=</span><span class="va">True</span>, fontsize<span class="op">=</span><span class="st">'x-large'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Nota las dobles barras invertidas en la línea de abajo</span></span>
<span><span class="fu">plt.xlabel</span><span class="op">(</span><span class="st">'Éste es el eje x. También puede contener matemática, como $\\bar{x}=\\frac{\\sum_{i=1}^{n} {x}} {N}$'</span><span class="op">)</span></span>
<span><span class="fu">plt.ylabel</span><span class="op">(</span><span class="st">'Éste es el eje y'</span><span class="op">)</span></span>
<span><span class="fu">plt.title</span><span class="op">(</span><span class="st">'Éste es el título de la figura'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plt.show</span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>{: .language-python}</p>
</div>
<div class="section level2">
<h2 id="working-with-sql">09-working-with-sql<a class="anchor" aria-label="anchor" href="#working-with-sql"></a></h2>
<p>FIXME</p>
<p><a href="https://matplotlib.org/users/mathtext.html" class="external-link">Ésta página</a>
contiene más información.</p>
</div>
</div>


      </div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/index.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/index.html" rel="prev"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/index.html" rel="next">Next... <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/fishtree-attempt/python-ecology-lesson-es/edit/main/_extras/guide.md" class="external-link">Edit on GitHub</a>
        
        
        
        | <a href="https://github.com/fishtree-attempt/python-ecology-lesson-es/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/fishtree-attempt/python-ecology-lesson-es/" class="external-link">Source</a></p>
				<p><a href="https://github.com/fishtree-attempt/python-ecology-lesson-es/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="../LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper" class="external-link">sandpaper (0.10.8)</a>,
        <a href="https://github.com/carpentries/pegboard/tree/0.3.2" class="external-link">pegboard (0.3.2)</a>,
      and <a href="https://github.com/carpentries/varnish/tree/0.2.9" class="external-link">varnish (0.2.9)</a>.</p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://preview.carpentries.org/python-ecology-lesson-es/instructor/guide.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Notas de Instructor",
  "creativeWorkStatus": "active",
  "url": "https://preview.carpentries.org/python-ecology-lesson-es/instructor/guide.html",
  "identifier": "https://preview.carpentries.org/python-ecology-lesson-es/instructor/guide.html",
  "dateCreated": "2022-11-15",
  "dateModified": "2022-11-15",
  "datePublished": "2022-11-15"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

